<div class="dashboard-layout">
  <!-- Barra superior -->
  <header class="top-bar">
    <div class="top-bar-left">
      <button class="menu-toggle" (click)="toggleSidebar()" aria-label="Toggle menu">
        <span class="hamburger-icon">â˜°</span>
      </button>
      <h1 class="app-title">Avaltrust Dashboard</h1>
    </div>

    <div class="top-bar-right">
      <div class="user-menu" *ngIf="userProfile() as profile">
        <button class="user-menu-trigger" (click)="toggleUserMenu()">
          <img [src]="getUserAvatar()" alt="Avatar" class="user-avatar">
          <span class="user-name">{{ profile.username }}</span>
          <span class="dropdown-arrow">â–¼</span>
        </button>

        <!-- MenÃº desplegable del usuario -->
        <div class="user-dropdown" [class.open]="isUserMenuOpen">
          <div class="user-info">
            <img [src]="getUserAvatar()" alt="Avatar" class="user-avatar-large">
            <div class="user-details">
              <div class="username">{{ profile.username }}</div>
              <div class="user-role">{{ profile.isAdmin ? 'Administrador' : 'Usuario' }}</div>
              <div class="user-email" *ngIf="profile.email">{{ profile.email }}</div>
            </div>
          </div>

          <div class="dropdown-divider"></div>

          <button class="dropdown-item" (click)="navigateTo('/user/profile'); closeUserMenu()">
            <span class="item-icon">ğŸ‘¤</span>
            Mi Perfil
          </button>

          <button class="dropdown-item" (click)="navigateTo('/user/settings'); closeUserMenu()">
            <span class="item-icon">âš™ï¸</span>
            ConfiguraciÃ³n
          </button>

          <div class="dropdown-divider"></div>

          <button class="dropdown-item logout-item" (click)="logout()">
            <span class="item-icon">ğŸšª</span>
            Cerrar SesiÃ³n
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Overlay para cerrar menÃºs en mÃ³vil -->
  <div
    class="overlay"
    [class.active]="isSidebarOpen || isUserMenuOpen"
    (click)="closeSidebar(); closeUserMenu()">
  </div>

  <!-- MenÃº lateral -->
  <aside class="sidebar" [class.open]="isSidebarOpen">
    <div class="sidebar-header">
      <div class="logo">
        <span class="logo-icon">ğŸ¢</span>
        <span class="logo-text">Avaltrust</span>
      </div>
    </div>

    <nav class="sidebar-nav">
      <!-- SecciÃ³n principal -->
      <div class="nav-section">
        <h3 class="section-title">Principal</h3>

        <button class="nav-item active" (click)="navigateTo('/dashboard')">
          <span class="nav-icon">ğŸ </span>
          <span class="nav-label">Dashboard</span>
        </button>
      </div>

      <!-- MenÃº especÃ­fico por rol -->
      <div class="nav-section" *ngFor="let item of getMenuItems()">
        <button class="nav-item" (click)="navigateTo(item.route)">
          <span class="nav-icon">{{ item.icon }}</span>
          <span class="nav-label">{{ item.label }}</span>
        </button>
      </div>

      <!-- SecciÃ³n de acceso rÃ¡pido solo para admin -->
      <div class="nav-section" *appHasRole="'ROLE_ADMIN'">
        <h3 class="section-title">AdministraciÃ³n</h3>

        <button class="nav-item admin-item" (click)="goToAdmin()">
          <span class="nav-icon">âš™ï¸</span>
          <span class="nav-label">Panel Admin</span>
        </button>
      </div>

      <!-- SecciÃ³n para usuarios regulares -->
      <div class="nav-section" *appHasRole="'ROLE_USER'">
        <h3 class="section-title">Mi Ãrea</h3>

        <button class="nav-item user-item" (click)="goToUserArea()">
          <span class="nav-icon">ğŸ‘¤</span>
          <span class="nav-label">Ãrea Personal</span>
        </button>
      </div>
    </nav>

    <!-- Footer del sidebar -->
    <div class="sidebar-footer">
      <div class="user-mini-profile" *ngIf="userProfile() as profile">
        <img [src]="getUserAvatar()" alt="Avatar" class="mini-avatar">
        <div class="mini-user-info">
          <div class="mini-username">{{ profile.username }}</div>
          <div class="mini-role">{{ profile.isAdmin ? 'Admin' : 'Usuario' }}</div>
        </div>
      </div>
    </div>
  </aside>

  <!-- Contenido principal -->
  <main class="main-content">
    <div class="content-header">
      <h2>Bienvenido al Sistema</h2>
      <p *ngIf="userProfile() as profile" class="welcome-message">
        Hola <strong>{{ profile.username }}</strong>, tienes acceso como
        <span class="role-badge" [class.admin-badge]="profile.isAdmin" [class.user-badge]="!profile.isAdmin">
          {{ profile.isAdmin ? 'Administrador' : 'Usuario' }}
        </span>
      </p>
    </div>

    <!-- Cards de resumen -->
    <div class="dashboard-cards">
      <!-- Card para administradores -->
      <div class="dashboard-card admin-card" *appHasRole="'ROLE_ADMIN'">
        <div class="card-icon admin-icon">âš™ï¸</div>
        <div class="card-content">
          <h3>Panel de AdministraciÃ³n</h3>
          <p>Gestiona usuarios, configura el sistema y accede a reportes detallados.</p>
          <button class="card-button" (click)="goToAdmin()">Acceder al Panel</button>
        </div>
      </div>

      <!-- Card para usuarios -->
      <div class="dashboard-card user-card">
        <div class="card-icon user-icon">ğŸ‘¤</div>
        <div class="card-content">
          <h3>Mi Ãrea Personal</h3>
          <p>Accede a tus documentos, solicitudes y configura tu perfil.</p>
          <button class="card-button" (click)="goToUserArea()">Ir a Mi Ãrea</button>
        </div>
      </div>

      <!-- Card de estadÃ­sticas (ejemplo) -->
      <div class="dashboard-card stats-card">
        <div class="card-icon stats-icon">ğŸ“Š</div>
        <div class="card-content">
          <h3>EstadÃ­sticas</h3>
          <p>Revisa tu actividad y estadÃ­sticas de uso del sistema.</p>
          <button class="card-button" (click)="navigateTo('/user/stats')">Ver EstadÃ­sticas</button>
        </div>
      </div>

      <!-- Card de soporte -->
      <div class="dashboard-card support-card">
        <div class="card-icon support-icon">ğŸ“</div>
        <div class="card-content">
          <h3>Soporte</h3>
          <p>Â¿Necesitas ayuda? Contacta con nuestro equipo de soporte.</p>
          <button class="card-button" (click)="navigateTo('/user/support')">Contactar</button>
        </div>
      </div>
    </div>

    <!-- SecciÃ³n de acciones rÃ¡pidas -->
    <div class="quick-actions">
      <h3>Acciones RÃ¡pidas</h3>
      <div class="actions-grid">
        <!-- Acciones para administradores -->
        <div *appHasRole="'ROLE_ADMIN'" class="action-group">
          <button class="action-btn admin-action" (click)="navigateTo('/admin/users')">
            <span class="action-icon">ğŸ‘¥</span>
            Gestionar Usuarios
          </button>
          <button class="action-btn admin-action" (click)="navigateTo('/admin/reports')">
            <span class="action-icon">ğŸ“ˆ</span>
            Ver Reportes
          </button>
          <button class="action-btn admin-action" (click)="navigateTo('/admin/settings')">
            <span class="action-icon">âš¡</span>
            ConfiguraciÃ³n
          </button>
        </div>

        <!-- Acciones para usuarios -->
        <div class="action-group">
          <button class="action-btn user-action" (click)="navigateTo('/user/requests')">
            <span class="action-icon">ğŸ“‹</span>
            Nueva Solicitud
          </button>
          <button class="action-btn user-action" (click)="navigateTo('/user/documents')">
            <span class="action-icon">ğŸ“„</span>
            Mis Documentos
          </button>
          <button class="action-btn user-action" (click)="navigateTo('/user/profile')">
            <span class="action-icon">ğŸ”§</span>
            Editar Perfil
          </button>
        </div>
      </div>
    </div>
  </main>
</div>
